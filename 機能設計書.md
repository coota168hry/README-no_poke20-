# README(no_poke20)

# 1.概要

---

## 1−1. 目的
---

### 実装目的

- 某配信者のファンサイトとして、ポケットモンスターシリーズ配信企画での使用を想定したアプリケーションを作成する
    - 企画の概要
        - ポケットモンスターシリーズ
        - ゲームを進めていく中で、初見のポケモンと遭遇した際、その姿を見ずに図鑑の説明文だけで絵を描いて似ていたら捕獲できるという
    - 課題
        - 検索エンジンから検索するとどうしてもポケモンの画像等ネタバレになる情報が表示されてしまう
        - 視聴者から図鑑情報のテキストのみを都度送付してもらっており、リスクも高く利便性も低い状況であった

### 実装概要

- ポケモンの名称を入力、ソフトを選択することで、図鑑説明分のみが検索できる機能を実装する
- ポケモンのイラストは表示させない（図鑑説明のみでポケモンを描くという企画のため）
- PCでの使用をメインのスコープとするが、ポートフォリオとして作成するため、スマホ対応のフレキシブルレイアウトも作成する
- UIは配信画面に表示させた際に他配信画面オブジェクトとの整合性が取れるよう、レトロゲーム調のデザインとする
- 図鑑データ収集用に、スクレイピングツールを作成する
- 実際に利用してもらう想定のため、ドメインの取得、およびSSL化は実施する

### その他、学習としての目的

- 前職で担当していたのがアプリケーション層のサーバーサイド機能実装、保守運用のみ
    - →他分野の知識が薄いことが個人的な課題であったため、フロント機能の実装、環境構築を含めてリリースまでを短期間かつ一期通貫で行う
- 低コストで実装できるため、ランダムで表示できる機能も合わせて実装する
- 技術選定
    - MVCモデルフレームワークの使用、クラウド環境の使用を習得する
    - その他、独学のため不明点で作業が止まらないよう、ドキュメントが豊富であることを選定基準とする
        - 環境：AWS（EC2,RDS,ROUTE53）
        - サーバ：nginx,puma
        - 言語：Ruby（Ruby on Rails）
        - 

# 2.機能設計

---

## 2-0. 機能概要

---

### 2-0-1. 機能一覧

| 項番 | 設計章番 | 機能名称 | 概要 |
| --- | --- | --- | --- |
| 1 | 2-1 | ホーム画面 | ホーム画面 |
| 2 | 2-2 | 図鑑ランダム表示機能 | 世代をキーに、図鑑説明テーブルからデータを取得し画面表示する |
| 3 | 2-3 | 図鑑検索機能 | 「ポケモン名/ソフト」をキーに、図鑑説明テーブルからデータを取得し、画面表示する |
| 4 | 2-4 | スクレイピングツール | 図鑑データ収集用に作成、初回実装時のみ利用対象サイト：https://wiki.xn--rckteqa2e.com/※アクセス数＝ポケモン数となるため1000回程度、　利用ルールには抵触しない |

### 2-0-2. 画面遷移図

![Untitled](./README(no_poke20)%20/Untitled.png)

### 2−0−3. 画面イメージ

![Untitled](./README(no_poke20)%20/Untitled_2.png)

結果画面

![Untitled](./README(no_poke20)%20/Untitled_3.png)

スマートフォン

![Untitled](./README(no_poke20)%20/Untitled_4.png)

### 2-0-4. ER図

![Untitled](./README(no_poke20)%20/Untitled_5.png)

### 2−0−5. AWS構成図

![Untitled](./README(no_poke20)%20/Untitled_6.png)

## 2−1. 共通・ホーム画面
---

### 2−1−1. 画面オブジェクト整理

- 共通
    - ヘッダ
        - ロゴ（ホームリンク）
        - ランダム画面リンク
        - 検索画面リンク
    - フッタ
        - コピーライト
- ホーム画面
    - アブストラクション
    - ランダム画面リンク
    - 検索画面リンク

### 2-1-2. 機能

- ホーム画面
- アブストラクションと各画面へのリンクのみ

### 2-1-3.テーブル設計

※タイムスタンプは省略

図鑑説明テーブル（poke_indices）

| カラム | 名称 | key | 型 | 備考 |
| --- | --- | --- | --- | --- |
| id | レコードID | PK | BIGINT |  |
| pokemon_id | ポケモン番号 | FK | INT |  |
| soft_id | ソフト番号 | FK | INT |  |
| index_text | 図鑑説明 |  | text |  |

ポケモンテーブル(pokemons)

| カラム | 名称 | key | 型 | 備考 |
| --- | --- | --- | --- | --- |
| id | ポケモンID | PK | BIGINT |  |
| poke_name | ポケモン名称 |  | INT |  |
| generation_id | 世代ID | FK | STRING |  |

ソフトテーブル(softs)

| カラム | 名称 | key | 型 | 備考 |
| --- | --- | --- | --- | --- |
| id | ソフトID | PK | BIGINT |  |
| soft_name | ソフト名称 |  | INT |  |
| generation_id | 世代ID | FK | STRING |  |

世代テーブル(generations)

| カラム | 名称 | key | 型 | 備考 |
| --- | --- | --- | --- | --- |
| id | 世代ID | PK | BIGINT |  |
| generation_name | 世代名称 |  | VARCHAR |  |

## 2-2. 図鑑ランダム表示機能

---

### 2−2−1. 画面オブジェクト整理

- ランダム画面
    - Submitボタン
    - 世代選択（チェックボックス）
- 結果画面
    - ポケモン名称
    - ソフト名称
    - 図鑑説明テキスト
    - 戻る

### 2-2-2. 機能

- 世代を選択し、その世代に登場したポケモンをランダムで検索する
    - 登場した世代が早いほど、世代を追うにつれて図鑑数が多くなる性質がある
    - →まず選択された世代から一つを抽出し、その世代からランダムで選択する仕様とする
- 世代はチェックボックスとする
- チェックボックス未選択の場合、完全ランダム
- 検索条件

| 取得項目 | ソフト.ソフト名称、ポケモン.ポケモン名称、図鑑.図鑑テキスト |
| --- | --- |
| 対象テーブル | 図鑑テーブル、ポケモン（副問合せ）、ソフトテーブル |
| 結合 | 図鑑.ポケモンID = ポケモン.ID<br>(※ポケモン（副問合せ）<br>取得：ポケモン.ID、ポケモン.ポケモン名称、世代.世代名称テーブル：ポケモン、世代<br>条件：ポケモン.世代ID = 世代.ID)<br>図鑑.ソフトID = ソフト.id |
| 条件 | ポケモン.世代名称 = 画面選択した世代からランダムで一世代（完全ランダムの場合なし） |

## 2-3.ポケモン検索機能

---

### 2-3-1.画面オブジェクト整理

- 検索画面
    - 検索フォーム
    - ソフト選択（ラジオボタン）
- 結果画面
    - ポケモン名称
    - ソフト名称
    - 図鑑説明テキスト
    - 戻る

### 2-3-2.機能

検索機能

- 検索文言は完全一致
- 検索候補は設けない（他ポケモンのネタバレ防止）
- ソフト選択は単一選択（ラジオボタン）。
    - 他ソフトのデータもみたいとの要件があれば複数選択対応する（チェックボックス）
        - 検索結果も複数表示できるよう対応する
    - 結果画面→検索画面に戻る際、選択したソフトの値を返し、ラジオボタンの初期値として設定する
        - ソフトの選択ミスを防ぐ目的
- テーブルのナチュラルキーは「ポケモン名/ソフト」とする。
    - 別途サロゲートキーを設ける
- 図鑑説明目的のため、フォルム違いは一つのカラムにまとめる（あくまでキーは「ポケモン名/ソフト」）
- 検索条件

| 取得項目 | ソフト.ソフト名称、ポケモン.ポケモン名称、図鑑.図鑑テキスト |
| --- | --- |
| 対象テーブル | 図鑑テーブル、ポケモンテーブル、ソフトテーブル |
| 結合 | 図鑑.ポケモンID = ポケモン.ID図鑑.ソフトID = ソフト.id |
| 条件 | ポケモン.ポケモン名称 = 画面入力.ポケモン名称ソフト.ソフト名称 = 画面選択.ソフト名称 |

### 9. ドキュメント一覧

---

| 名称 | 概要 | 備考 |
| --- | --- | --- |
| 機能設計書 | 機能設計（簡易版） | --- |
| データ定義書 | ER図、テーブル定義 |  |
| 画面定義書 | 画面遷移 |  |
| scraping.py | スクレイピングツール | 初回のみ利用ツールのためリファクタリング未済 |